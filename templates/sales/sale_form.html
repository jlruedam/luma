{% extends "base.html" %}
{% block title %}{{ 'Edit Sale' if form.tour_id.data else 'New Sale' }}{% endblock %}

{% block content %}
<h2 class="title">{{ 'Edit Sale' if form.tour_id.data else 'Register New Sale' }}</h2>

<form method="POST" class="form-sale">
    {{ form.hidden_tag() }}

    {% with errors=form.errors %}
    {% if errors %}
        <div class="form-errors">
            <ul>
            {% for field, error_list in errors.items() %}
                {% for error in error_list %}
                    <li><strong>{{ field }}:</strong> {{ error }}</li>
                {% endfor %}
            {% endfor %}
            </ul>
        </div>
    {% endif %}
    {% endwith %}

    <div class="form-group">
        <label>
            {{ form.tour_id.label }}
            <a href="{{ url_for('tours.create_tour') }}" class="btn-icon-small" title="Add new tour">➕</a>
        </label>
        {{ form.tour_id(class="form-input") }}
    </div>

    <div class="form-group">
        <label>
            {{ form.client_id.label }}
            <a href="{{ url_for('clients.create_client') }}" class="btn-icon-small" title="Add new client">➕</a>
        </label>
        {{ form.client_id(class="form-input") }}
    </div>

    <div class="form-group">
        <label>
            {{ form.vendor1_id.label }}
            <a href="{{ url_for('vendors.create_vendor') }}" class="btn-icon-small" title="Add vendor 1">➕</a>
        </label>
        {{ form.vendor1_id(class="form-input") }}
    </div>

    <div class="form-group">
        <label>
            {{ form.vendor2_id.label }}
            <a href="{{ url_for('vendors.create_vendor') }}" class="btn-icon-small" title="Add vendor 2">➕</a>
        </label>
        {{ form.vendor2_id(class="form-input") }}
    </div>

    <div class="form-group">
        {{ form.quantity.label }}<br>
        {{ form.quantity(class="form-input", placeholder="e.g., 1") }}
    </div>

    <div class="form-group">
        {{ form.options_payment.label }}<br>
        {{ form.options_payment(class="form-input", placeholder="Cash, Credit, Transfer...") }}
    </div>

    <div class="form-group">
        {{ form.observations.label }}<br>
        {{ form.observations(class="form-input", placeholder="Any relevant note...") }}
    </div>

    <div class="form-group">
        {{ form.submit(class="form-button") }}
        <a href="{{ url_for('sales.list_sales') }}" class="form-cancel">Cancel</a>
    </div>
</form>
{% endblock %}